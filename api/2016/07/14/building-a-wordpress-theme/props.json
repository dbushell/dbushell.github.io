{
  "dateUnix": 1468490400000,
  "dateFormatted": "Thursday 14 Jul 2016",
  "pageHeading": "Building a WordPress Theme",
  "pagePath": "/2016/07/14/building-a-wordpress-theme/",
  "innerHTML": "<p>I was delighted when <a href=\"https://www.basecreative.co.uk/\">Base Creative</a> asked me to help build a beautifully designed website on WordPress. It’s always a joy to work with Base Creative knowing that my role is made easier by the care and attention they deliver.</p>\n<p class=\"b-post__image\"><img src=\"/images/blog/wordpress-bc-theme.png\" alt=\"Website design by Base Creative, London\"></p>\n\n<p class=\"p--large\">In this review I’ll showcase a few of the defining techniques and challenges that made this an interesting project to deliver. As usual I started with a static HTML build allowing me to focus on CSS and responsiveness in the browser.</p>\n\n<hr>\n<h2 id=\"responsive-patterns\">Responsive Patterns</h2>\n<p>Overall the design adapted nicely across devices. The “article” component, used for listings blog posts, proved most challenging to code. The screenshots below illustrate how articles are designed to sit within a grid, resize, and change layout across breakpoints.</p>\n<p class=\"b-post__image\"><img src=\"/images/blog/wordpress-bc-articles.png\" alt=\"Blog article design by Base Creative, London\"></p>\n\n<p>Where possible I always aim to use standardised WordPress features. <a href=\"https://codex.wordpress.org/Post_Thumbnails\"><strong>Post Thumbnails</strong></a> were the logical target for these article images. It’s important to avoid requiring multiple images because they make content management a chore.</p>\n<p>Through experimentation in the browser I discovered the optimal image size to cover all breakpoints. CSS is used to effectively center and crop the image if its aspect ratio differs to that of its parent container. Flexbox is used in supported browsers for perfect alignment. It’s remarkably tricky otherwise to get those buttons aligned to the bottom of the box!</p>\n<p>Building the the CSS and HTML templates first lead to a much easier process of deconstruction and reassembling into a WordPress theme.</p>\n<h2 id=\"moving-to-wordpress\">Moving to WordPress</h2>\n<p>For WordPress development I use <a href=\"https://www.mamp.info/en/\">MAMP PRO</a> because its fast to setup and manage local installs. To really make the most of WordPress as a <strong>content management system</strong> I find the <a href=\"https://www.advancedcustomfields.com/\">Advanced Custom Fields</a> plugin to be indispensable.</p>\n<p>With ACF I’ll often create a general options page to configure content. The homepage design for this website has two featured articles. I provided options to show or hide as well as specify the exact content to be featured.</p>\n<p><em>When building a WordPress theme it’s important to consider all scenarios and provide safe defaults alongside more granular control for the author if they desire</em>.</p>\n<p class=\"b-post__image\"><img src=\"/images/blog/wordpress-bc-general-settings.png\" alt=\"WordPress homepage options\"></p>\n\n<p>It’s debatable whether to show these fields on the general options page or when editing the homepage itself. Because there is similar featured content that appears across multiple templates I opted to keep all of these options in one place.</p>\n<h3 id=\"content-blocks\">Content Blocks</h3>\n<p>Some blog posts will lead with a YouTube video. To provide the necessary CMS fields and taxonomy I combined the standard WordPress <a href=\"https://codex.wordpress.org/Post_Formats\">Post Formats</a> with conditional ACF options:</p>\n<p class=\"b-post__image\"><img src=\"/images/blog/wordpress-bc-video-format.png\" alt=\"WordPress post formats\"></p>\n\n<p>It would have been easier to simply expect the author to paste embed code within the main content editor. This is bad practice for several reasons:</p>\n<ol>\n<li>There would be no clean way to identify video posts within templates or searches.</li>\n<li>The editing experience is much friendlier when content is broken down into individual blocks with specific UI and instructions.</li>\n<li>It is harder to validate and sanitise mixed content.</li>\n</ol>\n<p>To output the video atop the single page template required little code:</p>\n<pre><code class=\"language-php\"><span class=\"token delimiter\">&lt;?php</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">has_post_format</span><span class=\"token punctuation\">(</span><span class=\"token string\">'video'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$code</span> <span class=\"token operator\">=</span> <span class=\"token function\">video_embed_code</span><span class=\"token punctuation\">(</span><span class=\"token function\">get_field</span><span class=\"token punctuation\">(</span><span class=\"token string\">'video-embed-code'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">the_content</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter\">?></span>\n</code></pre>\n<p>The <code>video_embed_code()</code> function exists in the theme’s <code>function.php</code> and uses the WordPress function <code>wp_kses()</code> <a href=\"https://codex.wordpress.org/Function_Reference/wp_kses\">(see docs)</a> to help sanitise content by allowing only specific HTML elements and attributes — an <code>&lt;iframe&gt;</code> or <code>&lt;video&gt;</code> in this case.</p>\n<h2 id=\"infinite-scroll\">Infinite Scroll</h2>\n<p>Infinite scroll is super simple to implement for WordPress!</p>\n<p>After some trial and error I settled on the aptly named, if a tad longwinded, <a href=\"https://wordpress.org/plugins/infinite-scroll-and-load-more-ajax-pagination/\">“Infinite Scroll and Load More Ajax Pagination”</a> plugin to do exactly what I needed (without the feature bloat that spoils many plugins).</p>\n<p>For the infinite scroll to work you first implement the blog with standard “Previous” and “Next” pagination. At this stage blog pages are now perfectly <strong>accessible</strong> and <strong>indexable</strong>. Then you tell the plugin your CSS selectors:</p>\n<p class=\"b-post__image\"><img src=\"/images/blog/wordpress-bc-infinite-scroll.png\" alt=\"WordPress infinite scroll plugin settings\"></p>\n\n<p>These selectors match the HTML structure I’ve used for blog listings and pagination:</p>\n<pre><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>grid grid--infinite<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>grid__item grid__item--infinite<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>article</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>article<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span> ... <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>article</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\" spellcheck=\"true\">&lt;!-- grid__item repeats per post --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>pagination<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>button button--pagination-prev<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Previous<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>button button--pagination-next<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Next<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n</code></pre>\n<p>The plugin uses JavaScript to replace the pagination with a customisable “More” button:</p>\n<p class=\"b-post__image\"><img src=\"/images/blog/wordpress-bc-infinite-load.gif\" alt=\"WordPress infinite scroll loading\"></p>\n\n<p>When clicked, blog posts from previous pages are loaded and appended to the grid. There is of course an option to automatically load new articles on scroll for the true “infinite scroll” effect. Personally I prefer a button because unexpected changes that force the page to repaint can cause scroll lag and jumpiness on mobile.</p>\n<p>This is a clean example of <strong>progressive enhancement</strong> in action.</p>\n<h2 id=\"wp-admin\">WP Admin</h2>\n<p>Once I’ve built a theme I’ll take time to ensure the WordPress admin area is presented as nicely as possible. One particularly nice touch is to give the content editor the same typographic style and web fonts as the theme.</p>\n<p class=\"b-post__image\"><img src=\"/images/blog/wordpress-bc-editor.png\" alt=\"WordPress content editor\"></p>\n\n\n\n<p>In the theme’s <code>functions.php</code> this WordPress function loads CSS into the editor:</p>\n<pre><code class=\"language-php\"><span class=\"token function\">add_editor_style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'assets/css/editor.css'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>To ensure the correct HTML classes are applied to typographic elements see <a href=\"https://codex.wordpress.org/TinyMCE_Custom_Styles\">TinyMCE Custom Styles</a>. To load web fonts a TinyMCE plugin is used:</p>\n<pre><code class=\"language-php\"><span class=\"token function\">add_filter</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mce_external_plugins'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'my__mce_external_plugins'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">my__mce_external_plugins</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$plugins</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$plugins</span><span class=\"token punctuation\">[</span><span class=\"token string\">'webfonts'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_template_directory_uri</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token string\">'/assets/js/admin/tinymce.webfonts.js'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$plugins</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>And the TinyMCE plugin itself:</p>\n<pre><code class=\"language-javascript\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  tinymce<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tinymce.plugins.webfonts'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    init<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>ed<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      ed<span class=\"token punctuation\">.</span>onPreInit<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>ed<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> doc <span class=\"token operator\">=</span> ed<span class=\"token punctuation\">.</span><span class=\"token function\">getDoc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            script <span class=\"token operator\">=</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'script'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            js <span class=\"token operator\">=</span> <span class=\"token string\">'WebFontConfig={google:{families:[\"Hind+Vadodara:500,300,400:latin\",\"Volkhov:400italic:latin\"]}},function(){var e=document.createElement(\"script\");e.src=\"https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js\",e.type=\"text/javascript\",e.async=\"true\";var t=document.getElementsByTagName(\"script\")[0];t.parentNode.insertBefore(e,t)}();'</span><span class=\"token punctuation\">;</span>\n        script<span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">'text/javascript'</span><span class=\"token punctuation\">;</span>\n        script<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">.</span><span class=\"token function\">createTextNode</span><span class=\"token punctuation\">(</span>js<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        doc<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'head'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>script<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    getInfo<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  tinymce<span class=\"token punctuation\">.</span>PluginManager<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webfonts'</span><span class=\"token punctuation\">,</span> tinymce<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span>webfonts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>This example uses Google Fonts but it’s trivial to replace the JavaScript with that of Typekit or another service. (It’s basically creating a <code>&lt;script&gt;</code> element inside the TinyMCE iframe.)</p>\n<h2 id=\"to-conclude\">To Conclude</h2>\n<p>Hopefully that gives you a glimpse into my process. These are just a few of the interesting aspects that make up WordPress theme development. WordPress has a lot of conventions and knowing these leads to a more robust and compatible theme.</p>\n<p>Thanks again to <a href=\"https://www.basecreative.co.uk/\"><strong>Base Creative</strong></a> for involving me in this project. If you have a WordPress theme that needs designed or built — or both! — <a href=\"/contact/\">please do get in touch</a>.</p>\n",
  "pageExcerpt": "I was delighted when Base Creative asked me to help build a beautifully designed website on WordPress. It’s always a joy to work with Base Creative knowing that my role is made easier by the care and attention they deliver.\n\n\nIn this review I’ll showcase a few of the defining techniques and challenges that made this […]",
  "pageUndated": true,
  "pageTitle": "Building a WordPress Theme – David Bushell – Web Design (UK)"
}