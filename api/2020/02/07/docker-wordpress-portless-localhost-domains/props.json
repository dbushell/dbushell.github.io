{
  "dateUnix": 1581069600000,
  "dateFormatted": "Friday 7 Feb 2020",
  "pageHeading": "Docker, WordPress, and Portless Localhost Domains",
  "pagePath": "/2020/02/07/docker-wordpress-portless-localhost-domains/",
  "innerHTML": "<p>The <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://www.docker.com/\">Docker</a> life chooses you. I bet a lot of developers have had a similar introduction. You‚Äôre brought onto a project and it‚Äôs like; ‚Äú<em>Hey we‚Äôre using Docker, just run ‚Äòdocker-compose up‚Äô.</em>‚Äú they say, ‚Äú<em>Sure, I know Docker,</em>‚Äú you shrug. Then you spend the better part of the week debugging.</p>\n<p>I‚Äôve worked on maybe two dozen sites with the help of Docker over the years. The majority of them WordPress. The configuration file I‚Äôve been using has evolved from a complete mystery that I stole from the experience above, to something I‚Äôve been able to tweak after ‚Äòlearning‚Äô Docker on the job.</p>\n<p>One problem has been a thorn in my side.</p>\n<h2 id=\"virtual-hosts\">Virtual Hosts</h2>\n<p>Only one container can listen on localhost port 80 so you end up with:</p>\n<pre><code>my-blog.localhost:8081\nacme-corp.localhost:8082\n127.0.0.1:8090\nvaporware.localhost:9000</code></pre><p>Port juggling sucks. Even after avoiding conflicts, having to remember the port number diminishes the value of a domain. The solution is a <strong>reverse proxy</strong>. This can be achieved with <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://docs.traefik.io/\">Traefik</a>, which I could not figure out, or <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://www.nginx.com/\">NGINX</a>, which I did; <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://github.com/jwilder/nginx-proxy/\">nginx-proxy</a> by <em>Jason Wilder</em> automates like magic.</p>\n<p>After finding a happy solution I went back to update older projects. Rather than continuing to maintain what are effectively identical config files, I‚Äôve bundled a set of reusable templates and scripts into an NPM package.</p>\n<h2 id=\"docker-wordpress-scripts\">Docker WordPress Scripts</h2>\n<p>I‚Äôve started a small project to help manage WordPress containers in Docker.</p>\n<p class=\"b-post__image\"><img src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg==\" data-lazy=\"false\" data-src=\"/images/blog/2020/dws-logo.svg\" alt=\"Docker WordPress Scripts\"></p>\n<p>Have an early look at <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://github.com/dbushell/docker-wordpress-scripts\">Docker WordPress Scripts on GitHub</a>.</p>\n<p>DWS helps manage:</p>\n<ul>\n<li>A reusable <code>docker-compose.yml</code> template (WordPress, MariaDB, phpMyAdmin)</li>\n<li>A single instance of NGINX and <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://www.portainer.io/\">Portainer</a> with config files</li>\n<li>WordPress CLI installation and set up</li>\n<li>PHP config files</li>\n</ul>\n<p>When I start a new WordPress project I can just run:</p>\n<pre><code>$ dws up\n\nüêπ Success: WordPress is up and running!\nphpMyAdmin: ‚ûú http://pma.wpdemo.localhost\nWordPress:  ‚ûú http://wpdemo.localhost</code></pre><p>It will spin up new containers for my project and I‚Äôm good to go.</p>\n<p>The scripts are mostly wrappers for the <code>docker-compose</code> command. I no longer need to maintain any config files in individual repositories. But if I wanted to later, I can run <code>dws eject</code>. This command copies everything to the project directory and moves WordPress back to <code>localhost:8080</code> like my old set up.</p>\n<h3 id=\"work-in-progress\">Work in Progress</h3>\n<p>This is somewhat of a personal project but it solves a fairly common problem so I‚Äôm sharing it for anyone to use and adapt. It‚Äôs lacking in error feedback and I can‚Äôt provide much support but <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://twitter.com/dbushell\">@dbushell</a> on the chance I have a quick answer.</p>\n<p>I‚Äôll continue to improve DWS as I work with it in the coming months. The underlying interface with <code>docker-compose</code> is rather jury-rigged at the moment but it does the job. There are probably existing APIs I can utilised to improve this part immensely.</p>\n<p>If you want to set up a reverse proxy without the help of DWS take a look at the <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://github.com/dbushell/docker-wordpress-scripts/tree/master/config\">compose files in this directory</a>.</p>\n<p>You can find more extensive <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://github.com/dbushell/docker-wordpress-scripts/blob/master/README.md\">documentation on GitHub</a>.</p>\n<style>\n.b-post [src$=\"dws-logo.svg\"] {\n  background: #fff;\n  padding: 1.5rem;\n  width: 300px;\n}\n</style>\n",
  "pageExcerpt": "The Docker life chooses you. I bet a lot of developers have had a similar introduction. You‚Äôre brought onto a project and it‚Äôs like; ‚ÄúHey we‚Äôre using Docker, just run ‚Äòdocker-compose up‚Äô.‚Äú they say, ‚ÄúSure, I know Docker,‚Äú you shrug. Then you spend the better part of the week debugging.\nI‚Äôve worked on maybe two dozen [‚Ä¶]",
  "pageDesc": "The one where I share a project to manage WordPress containers in Docker.",
  "pageTitle": "Docker, WordPress, and Portless Localhost Domains ‚Äì David Bushell ‚Äì Web Design (UK)"
}