/*! iScroll v5.2.0-snapshot ~ (c) 2008-2017 Matteo Spinelli ~ http://cubiq.org/license */
(function(n,r,u){var f=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){n.setTimeout(t,1e3/60)};var m=function(){var s={};var o=r.createElement("div").style;var i=function(){var t=["t","webkitT","MozT","msT","OT"],i,e=0,s=t.length;for(;e<s;e++){i=t[e]+"ransform";if(i in o)return t[e].substr(0,t[e].length-1)}return false}();function t(t){if(i===false)return false;if(i==="")return t;return i+t.charAt(0).toUpperCase()+t.substr(1)}s.getTime=Date.now||function t(){return(new Date).getTime()};s.extend=function(t,i){for(var e in i){t[e]=i[e]}};s.addEvent=function(t,i,e,s){t.addEventListener(i,e,!!s)};s.removeEvent=function(t,i,e,s){t.removeEventListener(i,e,!!s)};s.prefixPointerEvent=function(t){return n.MSPointerEvent?"MSPointer"+t.charAt(7).toUpperCase()+t.substr(8):t};s.momentum=function(t,i,e,s,o,n){var r=t-i,h=u.abs(r)/e,a,l;n=n===undefined?6e-4:n;a=t+h*h/(2*n)*(r<0?-1:1);l=h/n;if(a<s){a=o?s-o/2.5*(h/8):s;r=u.abs(a-t);l=r/h}else if(a>0){a=o?o/2.5*(h/8):0;r=u.abs(t)+a;l=r/h}return{destination:u.round(a),duration:l}};var e=t("transform");s.extend(s,{hasTransform:e!==false,hasPerspective:t("perspective")in o,hasTouch:"ontouchstart"in n,hasPointer:!!(n.PointerEvent||n.MSPointerEvent),hasTransition:t("transition")in o});s.isBadAndroid=function(){var t=n.navigator.appVersion;if(/Android/.test(t)&&!/Chrome\/\d/.test(t)){var i=t.match(/Safari\/(\d+.\d)/);if(i&&typeof i==="object"&&i.length>=2){return parseFloat(i[1])<535.19}else{return true}}else{return false}}();s.extend(s.style={},{transform:e,transitionTimingFunction:t("transitionTimingFunction"),transitionDuration:t("transitionDuration"),transitionDelay:t("transitionDelay"),transformOrigin:t("transformOrigin"),touchAction:t("touchAction")});s.hasClass=function(t,i){var e=new RegExp("(^|\\s)"+i+"(\\s|$)");return e.test(t.className)};s.addClass=function(t,i){if(s.hasClass(t,i)){return}var e=t.className.split(" ");e.push(i);t.className=e.join(" ")};s.removeClass=function(t,i){if(!s.hasClass(t,i)){return}var e=new RegExp("(^|\\s)"+i+"(\\s|$)","g");t.className=t.className.replace(e," ")};s.offset=function(t){var i=-t.offsetLeft,e=-t.offsetTop;while(t=t.offsetParent){i-=t.offsetLeft;e-=t.offsetTop}return{left:i,top:e}};s.preventDefaultException=function(t,i){for(var e in i){if(i[e].test(t[e])){return true}}return false};s.extend(s.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});s.extend(s.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return u.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var i=4;return(t=t-1)*t*((i+1)*t+i)+1}},bounce:{style:"",fn:function(t){if((t/=1)<1/2.75){return 7.5625*t*t}else if(t<2/2.75){return 7.5625*(t-=1.5/2.75)*t+.75}else if(t<2.5/2.75){return 7.5625*(t-=2.25/2.75)*t+.9375}else{return 7.5625*(t-=2.625/2.75)*t+.984375}}},elastic:{style:"",fn:function(t){var i=.22,e=.4;if(t===0){return 0}if(t==1){return 1}return e*u.pow(2,-10*t)*u.sin((t-i/4)*(2*u.PI)/i)+1}}});s.tap=function(t,i){var e=r.createEvent("Event");e.initEvent(i,true,true);e.pageX=t.pageX;e.pageY=t.pageY;t.target.dispatchEvent(e)};s.click=function(t){var i=t.target,e;if(!/(SELECT|INPUT|TEXTAREA)/i.test(i.tagName)){e=r.createEvent(n.MouseEvent?"MouseEvents":"Event");e.initEvent("click",true,true);e.view=t.view||n;e.detail=1;e.screenX=i.screenX||0;e.screenY=i.screenY||0;e.clientX=i.clientX||0;e.clientY=i.clientY||0;e.ctrlKey=!!t.ctrlKey;e.altKey=!!t.altKey;e.shiftKey=!!t.shiftKey;e.metaKey=!!t.metaKey;e.button=0;e.relatedTarget=null;e._constructed=true;i.dispatchEvent(e)}};s.getTouchAction=function(t,i){var e="none";if(t==="vertical"){e="pan-y"}else if(t==="horizontal"){e="pan-x"}if(i&&e!="none"){e+=" pinch-zoom"}return e};s.getRect=function(t){if(t instanceof SVGElement){var i=t.getBoundingClientRect();return{top:i.top,left:i.left,width:i.width,height:i.height}}else{return{top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight}}};return s}();function t(t,i){this.wrapper=typeof t=="string"?r.querySelector(t):t;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:.334,disablePointer:!m.hasPointer,disableTouch:m.hasPointer||!m.hasTouch,disableMouse:m.hasPointer||m.hasTouch,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true,bindToWrapper:typeof n.onmousedown==="undefined"};for(var e in i){this.options[e]=i[e]}this.translateZ=this.options.HWCompositing&&m.hasPerspective?" translateZ(0)":"";this.options.useTransition=m.hasTransition&&this.options.useTransition;this.options.useTransform=m.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?m.ease[this.options.bounceEasing]||m.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}if(!this.options.useTransition&&!this.options.useTransform){if(!/relative|absolute/i.test(this.scrollerStyle.position)){this.scrollerStyle.position="relative"}}if(this.options.shrinkScrollbars=="scale"){this.options.useTransition=false}this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}t.prototype={version:"5.2.0-snapshot",_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators){this._initIndicators()}if(this.options.mouseWheel){this._initWheel()}if(this.options.snap){this._initSnap()}if(this.options.keyBindings){this._initKeys()}},destroy:function(){this._initEvents(true);clearTimeout(this.resizeTimeout);this.resizeTimeout=null;this._execEvent("destroy")},_transitionEnd:function(t){if(t.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(t){if(m.eventType[t.type]!=1){var i;if(!t.which){i=t.button<2?0:t.button==4?1:2}else{i=t.button}if(i!==0){return}}if(!this.enabled||this.initiated&&m.eventType[t.type]!==this.initiated){return}if(this.options.preventDefault&&!m.isBadAndroid&&!m.preventDefaultException(t.target,this.options.preventDefaultException)){t.preventDefault()}var e=t.touches?t.touches[0]:t,s;this.initiated=m.eventType[t.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this.startTime=m.getTime();if(this.options.useTransition&&this.isInTransition){this._transitionTime();this.isInTransition=false;s=this.getComputedPosition();this._translate(u.round(s.x),u.round(s.y));this._execEvent("scrollEnd")}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=e.pageX;this.pointY=e.pageY;this._execEvent("beforeScrollStart")},_move:function(t){if(!this.enabled||m.eventType[t.type]!==this.initiated){return}if(this.options.preventDefault){t.preventDefault()}var i=t.touches?t.touches[0]:t,e=i.pageX-this.pointX,s=i.pageY-this.pointY,o=m.getTime(),n,r,h,a;this.pointX=i.pageX;this.pointY=i.pageY;this.distX+=e;this.distY+=s;h=u.abs(this.distX);a=u.abs(this.distY);if(o-this.endTime>300&&(h<10&&a<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(h>a+this.options.directionLockThreshold){this.directionLocked="h"}else if(a>=h+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){t.preventDefault()}else if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}s=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){t.preventDefault()}else if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}e=0}e=this.hasHorizontalScroll?e:0;s=this.hasVerticalScroll?s:0;n=this.x+e;r=this.y+s;if(n>0||n<this.maxScrollX){n=this.options.bounce?this.x+e/3:n>0?0:this.maxScrollX}if(r>0||r<this.maxScrollY){r=this.options.bounce?this.y+s/3:r>0?0:this.maxScrollY}this.directionX=e>0?-1:e<0?1:0;this.directionY=s>0?-1:s<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(n,r);if(o-this.startTime>300){this.startTime=o;this.startX=this.x;this.startY=this.y}},_end:function(t){if(!this.enabled||m.eventType[t.type]!==this.initiated){return}if(this.options.preventDefault&&!m.preventDefaultException(t.target,this.options.preventDefaultException)){t.preventDefault()}var i=t.changedTouches?t.changedTouches[0]:t,e,s,o=m.getTime()-this.startTime,n=u.round(this.x),r=u.round(this.y),h=u.abs(n-this.startX),a=u.abs(r-this.startY),l=0,c="";this.isInTransition=0;this.initiated=0;this.endTime=m.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(n,r);if(!this.moved){if(this.options.tap){m.tap(t,this.options.tap)}if(this.options.click){m.click(t)}this._execEvent("scrollCancel");return}if(this._events.flick&&o<200&&h<100&&a<100){this._execEvent("flick");return}if(this.options.momentum&&o<300){e=this.hasHorizontalScroll?m.momentum(this.x,this.startX,o,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:n,duration:0};s=this.hasVerticalScroll?m.momentum(this.y,this.startY,o,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:r,duration:0};n=e.destination;r=s.destination;l=u.max(e.duration,s.duration);this.isInTransition=1}if(this.options.snap){var p=this._nearestSnap(n,r);this.currentPage=p;l=this.options.snapSpeed||u.max(u.max(u.min(u.abs(n-p.x),1e3),u.min(u.abs(r-p.y),1e3)),300);n=p.x;r=p.y;this.directionX=0;this.directionY=0;c=this.options.bounceEasing}if(n!=this.x||r!=this.y){if(n>0||n<this.maxScrollX||r>0||r<this.maxScrollY){c=m.ease.quadratic}this.scrollTo(n,r,l,c);return}this._execEvent("scrollEnd")},_resize:function(){var t=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var i=this.x,e=this.y;t=t||0;if(!this.hasHorizontalScroll||this.x>0){i=0}else if(this.x<this.maxScrollX){i=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){e=0}else if(this.y<this.maxScrollY){e=this.maxScrollY}if(i==this.x&&e==this.y){return false}this.scrollTo(i,e,t,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){m.getRect(this.wrapper);this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;var t=m.getRect(this.scroller);this.scrollerWidth=t.width;this.scrollerHeight=t.height;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;if(m.hasPointer&&!this.options.disablePointer){this.wrapper.style[m.style.touchAction]=m.getTouchAction(this.options.eventPassthrough,true);if(!this.wrapper.style[m.style.touchAction]){this.wrapper.style[m.style.touchAction]=m.getTouchAction(this.options.eventPassthrough,false)}}this.wrapperOffset=m.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(t,i){if(!this._events[t]){this._events[t]=[]}this._events[t].push(i)},off:function(t,i){if(!this._events[t]){return}var e=this._events[t].indexOf(i);if(e>-1){this._events[t].splice(e,1)}},_execEvent:function(t){if(!this._events[t]){return}var i=0,e=this._events[t].length;if(!e){return}for(;i<e;i++){this._events[t][i].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,i,e,s){t=this.x+t;i=this.y+i;e=e||0;this.scrollTo(t,i,e,s)},scrollTo:function(t,i,e,s){s=s||m.ease.circular;this.isInTransition=this.options.useTransition&&e>0;var o=this.options.useTransition&&s.style;if(!e||o){if(o){this._transitionTimingFunction(s.style);this._transitionTime(e)}this._translate(t,i)}else{this._animate(t,i,e,s.fn)}},scrollToElement:function(t,i,e,s,o){t=t.nodeType?t:this.scroller.querySelector(t);if(!t){return}var n=m.offset(t);n.left-=this.wrapperOffset.left;n.top-=this.wrapperOffset.top;var r=m.getRect(t);var h=m.getRect(this.wrapper);if(e===true){e=u.round(r.width/2-h.width/2)}if(s===true){s=u.round(r.height/2-h.height/2)}n.left-=e||0;n.top-=s||0;n.left=n.left>0?0:n.left<this.maxScrollX?this.maxScrollX:n.left;n.top=n.top>0?0:n.top<this.maxScrollY?this.maxScrollY:n.top;i=i===undefined||i===null||i==="auto"?u.max(u.abs(this.x-n.left),u.abs(this.y-n.top)):i;this.scrollTo(n.left,n.top,i,o)},_transitionTime:function(t){if(!this.options.useTransition){return}t=t||0;var i=m.style.transitionDuration;if(!i){return}this.scrollerStyle[i]=t+"ms";if(!t&&m.isBadAndroid){this.scrollerStyle[i]="0.0001ms";var e=this;f(function(){if(e.scrollerStyle[i]==="0.0001ms"){e.scrollerStyle[i]="0s"}})}if(this.indicators){for(var s=this.indicators.length;s--;){this.indicators[s].transitionTime(t)}}},_transitionTimingFunction:function(t){this.scrollerStyle[m.style.transitionTimingFunction]=t;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTimingFunction(t)}}},_translate:function(t,i){if(this.options.useTransform){this.scrollerStyle[m.style.transform]="translate("+t+"px,"+i+"px)"+this.translateZ}else{t=u.round(t);i=u.round(i);this.scrollerStyle.left=t+"px";this.scrollerStyle.top=i+"px"}this.x=t;this.y=i;if(this.indicators){for(var e=this.indicators.length;e--;){this.indicators[e].updatePosition()}}},_initEvents:function(t){var i=t?m.removeEvent:m.addEvent,e=this.options.bindToWrapper?this.wrapper:n;i(n,"orientationchange",this);i(n,"resize",this);if(this.options.click){i(this.wrapper,"click",this,true)}if(!this.options.disableMouse){i(this.wrapper,"mousedown",this);i(e,"mousemove",this);i(e,"mousecancel",this);i(e,"mouseup",this)}if(m.hasPointer&&!this.options.disablePointer){i(this.wrapper,m.prefixPointerEvent("pointerdown"),this);i(e,m.prefixPointerEvent("pointermove"),this);i(e,m.prefixPointerEvent("pointercancel"),this);i(e,m.prefixPointerEvent("pointerup"),this)}if(m.hasTouch&&!this.options.disableTouch){i(this.wrapper,"touchstart",this);i(e,"touchmove",this);i(e,"touchcancel",this);i(e,"touchend",this)}i(this.scroller,"transitionend",this);i(this.scroller,"webkitTransitionEnd",this);i(this.scroller,"oTransitionEnd",this);i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t=n.getComputedStyle(this.scroller,null),i,e;if(this.options.useTransform){t=t[m.style.transform].split(")")[0].split(", ");i=+(t[12]||t[4]);e=+(t[13]||t[5])}else{i=+t.left.replace(/[^-\d.]/g,"");e=+t.top.replace(/[^-\d.]/g,"")}return{x:i,y:e}},_initIndicators:function(){var t=this.options.interactiveScrollbars,i=typeof this.options.scrollbars!="string",e=[],s;var o=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){s={el:h("v",t,this.options.scrollbars),interactive:t,defaultScrollbars:true,customStyle:i,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(s.el);e.push(s)}if(this.options.scrollX){s={el:h("h",t,this.options.scrollbars),interactive:t,defaultScrollbars:true,customStyle:i,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(s.el);e.push(s)}}if(this.options.indicators){e=e.concat(this.options.indicators)}for(var n=e.length;n--;){this.indicators.push(new a(this,e[n]))}function r(t){if(o.indicators){for(var i=o.indicators.length;i--;){t.call(o.indicators[i])}}}if(this.options.fadeScrollbars){this.on("scrollEnd",function(){r(function(){this.fade()})});this.on("scrollCancel",function(){r(function(){this.fade()})});this.on("scrollStart",function(){r(function(){this.fade(1)})});this.on("beforeScrollStart",function(){r(function(){this.fade(1,true)})})}this.on("refresh",function(){r(function(){this.refresh()})});this.on("destroy",function(){r(function(){this.destroy()});delete this.indicators})},_initWheel:function(){m.addEvent(this.wrapper,"wheel",this);m.addEvent(this.wrapper,"mousewheel",this);m.addEvent(this.wrapper,"DOMMouseScroll",this);this.on("destroy",function(){clearTimeout(this.wheelTimeout);this.wheelTimeout=null;m.removeEvent(this.wrapper,"wheel",this);m.removeEvent(this.wrapper,"mousewheel",this);m.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(t){if(!this.enabled){return}t.preventDefault();var i,e,s,o,n=this;if(this.wheelTimeout===undefined){n._execEvent("scrollStart")}clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){if(!n.options.snap){n._execEvent("scrollEnd")}n.wheelTimeout=undefined},400);if("deltaX"in t){if(t.deltaMode===1){i=-t.deltaX*this.options.mouseWheelSpeed;e=-t.deltaY*this.options.mouseWheelSpeed}else{i=-t.deltaX;e=-t.deltaY}}else if("wheelDeltaX"in t){i=t.wheelDeltaX/120*this.options.mouseWheelSpeed;e=t.wheelDeltaY/120*this.options.mouseWheelSpeed}else if("wheelDelta"in t){i=e=t.wheelDelta/120*this.options.mouseWheelSpeed}else if("detail"in t){i=e=-t.detail/3*this.options.mouseWheelSpeed}else{return}i*=this.options.invertWheelDirection;e*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){i=e;e=0}if(this.options.snap){s=this.currentPage.pageX;o=this.currentPage.pageY;if(i>0){s--}else if(i<0){s++}if(e>0){o--}else if(e<0){o++}this.goToPage(s,o);return}s=this.x+u.round(this.hasHorizontalScroll?i:0);o=this.y+u.round(this.hasVerticalScroll?e:0);this.directionX=i>0?-1:i<0?1:0;this.directionY=e>0?-1:e<0?1:0;if(s>0){s=0}else if(s<this.maxScrollX){s=this.maxScrollX}if(o>0){o=0}else if(o<this.maxScrollY){o=this.maxScrollY}this.scrollTo(s,o,0)},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=="string"){this.options.snap=this.scroller.querySelectorAll(this.options.snap)}this.on("refresh",function(){var t=0,i,e=0,s,o,n,r=0,h,a=this.options.snapStepX||this.wrapperWidth,l=this.options.snapStepY||this.wrapperHeight,c,p;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return}if(this.options.snap===true){o=u.round(a/2);n=u.round(l/2);while(r>-this.scrollerWidth){this.pages[t]=[];i=0;h=0;while(h>-this.scrollerHeight){this.pages[t][i]={x:u.max(r,this.maxScrollX),y:u.max(h,this.maxScrollY),width:a,height:l,cx:r-o,cy:h-n};h-=l;i++}r-=a;t++}}else{c=this.options.snap;i=c.length;s=-1;for(;t<i;t++){p=m.getRect(c[t]);if(t===0||p.left<=m.getRect(c[t-1]).left){e=0;s++}if(!this.pages[e]){this.pages[e]=[]}r=u.max(-p.left,this.maxScrollX);h=u.max(-p.top,this.maxScrollY);o=r-u.round(p.width/2);n=h-u.round(p.height/2);this.pages[e][s]={x:r,y:h,width:p.width,height:p.height,cx:o,cy:n};if(r>this.maxScrollX){e++}}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold}else{this.snapThresholdX=u.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=u.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}});this.on("flick",function(){var t=this.options.snapSpeed||u.max(u.max(u.min(u.abs(this.x-this.startX),1e3),u.min(u.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,i){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0}}var e=0,s=this.pages.length,o=0;if(u.abs(t-this.absStartX)<this.snapThresholdX&&u.abs(i-this.absStartY)<this.snapThresholdY){return this.currentPage}if(t>0){t=0}else if(t<this.maxScrollX){t=this.maxScrollX}if(i>0){i=0}else if(i<this.maxScrollY){i=this.maxScrollY}for(;e<s;e++){if(t>=this.pages[e][0].cx){t=this.pages[e][0].x;break}}s=this.pages[e].length;for(;o<s;o++){if(i>=this.pages[0][o].cy){i=this.pages[0][o].y;break}}if(e==this.currentPage.pageX){e+=this.directionX;if(e<0){e=0}else if(e>=this.pages.length){e=this.pages.length-1}t=this.pages[e][0].x}if(o==this.currentPage.pageY){o+=this.directionY;if(o<0){o=0}else if(o>=this.pages[0].length){o=this.pages[0].length-1}i=this.pages[0][o].y}return{x:t,y:i,pageX:e,pageY:o}},goToPage:function(t,i,e,s){s=s||this.options.bounceEasing;if(t>=this.pages.length){t=this.pages.length-1}else if(t<0){t=0}if(i>=this.pages[t].length){i=this.pages[t].length-1}else if(i<0){i=0}var o=this.pages[t][i].x,n=this.pages[t][i].y;e=e===undefined?this.options.snapSpeed||u.max(u.max(u.min(u.abs(o-this.x),1e3),u.min(u.abs(n-this.y),1e3)),300):e;this.currentPage={x:o,y:n,pageX:t,pageY:i};this.scrollTo(o,n,e,s)},next:function(t,i){var e=this.currentPage.pageX,s=this.currentPage.pageY;e++;if(e>=this.pages.length&&this.hasVerticalScroll){e=0;s++}this.goToPage(e,s,t,i)},prev:function(t,i){var e=this.currentPage.pageX,s=this.currentPage.pageY;e--;if(e<0&&this.hasVerticalScroll){e=0;s--}this.goToPage(e,s,t,i)},_initKeys:function(t){var i={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var e;if(typeof this.options.keyBindings=="object"){for(e in this.options.keyBindings){if(typeof this.options.keyBindings[e]=="string"){this.options.keyBindings[e]=this.options.keyBindings[e].toUpperCase().charCodeAt(0)}}}else{this.options.keyBindings={}}for(e in i){this.options.keyBindings[e]=this.options.keyBindings[e]||i[e]}m.addEvent(n,"keydown",this);this.on("destroy",function(){m.removeEvent(n,"keydown",this)})},_key:function(t){if(!this.enabled){return}var i=this.options.snap,e=i?this.currentPage.pageX:this.x,s=i?this.currentPage.pageY:this.y,o=m.getTime(),n=this.keyTime||0,r=.25,h;if(this.options.useTransition&&this.isInTransition){h=this.getComputedPosition();this._translate(u.round(h.x),u.round(h.y));this.isInTransition=false}this.keyAcceleration=o-n<200?u.min(this.keyAcceleration+r,50):0;switch(t.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){e+=i?1:this.wrapperWidth}else{s+=i?1:this.wrapperHeight}break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){e-=i?1:this.wrapperWidth}else{s-=i?1:this.wrapperHeight}break;case this.options.keyBindings.end:e=i?this.pages.length-1:this.maxScrollX;s=i?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:e=0;s=0;break;case this.options.keyBindings.left:e+=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:s+=i?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:e-=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:s-=i?1:5+this.keyAcceleration>>0;break;default:return}if(i){this.goToPage(e,s);return}if(e>0){e=0;this.keyAcceleration=0}else if(e<this.maxScrollX){e=this.maxScrollX;this.keyAcceleration=0}if(s>0){s=0;this.keyAcceleration=0}else if(s<this.maxScrollY){s=this.maxScrollY;this.keyAcceleration=0}this.scrollTo(e,s,0);this.keyTime=o},_animate:function(o,n,r,h){var a=this,l=this.x,c=this.y,p=m.getTime(),u=p+r;function d(){var t=m.getTime(),i,e,s;if(t>=u){a.isAnimating=false;a._translate(o,n);if(!a.resetPosition(a.options.bounceTime)){a._execEvent("scrollEnd")}return}t=(t-p)/r;s=h(t);i=(o-l)*s+l;e=(n-c)*s+c;a._translate(i,e);if(a.isAnimating){f(d)}}this.isAnimating=true;d()},handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":if(this.enabled&&!t._constructed){t.preventDefault();t.stopPropagation()}break}}};function h(t,i,e){var s=r.createElement("div"),o=r.createElement("div");if(e===true){s.style.cssText="position:absolute;z-index:9999";o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"}o.className="iScrollIndicator";if(t=="h"){if(e===true){s.style.cssText+=";height:7px;left:2px;right:2px;bottom:0";o.style.height="100%"}s.className="iScrollHorizontalScrollbar"}else{if(e===true){s.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px";o.style.width="100%"}s.className="iScrollVerticalScrollbar"}s.style.cssText+=";overflow:hidden";if(!i){s.style.pointerEvents="none"}s.appendChild(o);return s}function a(t,i){this.wrapper=typeof i.el=="string"?r.querySelector(i.el):i.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=t;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var e in i){this.options[e]=i[e]}this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){m.addEvent(this.indicator,"touchstart",this);m.addEvent(n,"touchend",this)}if(!this.options.disablePointer){m.addEvent(this.indicator,m.prefixPointerEvent("pointerdown"),this);m.addEvent(n,m.prefixPointerEvent("pointerup"),this)}if(!this.options.disableMouse){m.addEvent(this.indicator,"mousedown",this);m.addEvent(n,"mouseup",this)}}if(this.options.fade){this.wrapperStyle[m.style.transform]=this.scroller.translateZ;var s=m.style.transitionDuration;if(!s){return}this.wrapperStyle[s]=m.isBadAndroid?"0.0001ms":"0ms";var o=this;if(m.isBadAndroid){f(function(){if(o.wrapperStyle[s]==="0.0001ms"){o.wrapperStyle[s]="0s"}})}this.wrapperStyle.opacity="0"}}a.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t);break}},destroy:function(){if(this.options.fadeScrollbars){clearTimeout(this.fadeTimeout);this.fadeTimeout=null}if(this.options.interactive){m.removeEvent(this.indicator,"touchstart",this);m.removeEvent(this.indicator,m.prefixPointerEvent("pointerdown"),this);m.removeEvent(this.indicator,"mousedown",this);m.removeEvent(n,"touchmove",this);m.removeEvent(n,m.prefixPointerEvent("pointermove"),this);m.removeEvent(n,"mousemove",this);m.removeEvent(n,"touchend",this);m.removeEvent(n,m.prefixPointerEvent("pointerup"),this);m.removeEvent(n,"mouseup",this)}if(this.options.defaultScrollbars&&this.wrapper.parentNode){this.wrapper.parentNode.removeChild(this.wrapper)}},_start:function(t){var i=t.touches?t.touches[0]:t;t.preventDefault();t.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=i.pageX;this.lastPointY=i.pageY;this.startTime=m.getTime();if(!this.options.disableTouch){m.addEvent(n,"touchmove",this)}if(!this.options.disablePointer){m.addEvent(n,m.prefixPointerEvent("pointermove"),this)}if(!this.options.disableMouse){m.addEvent(n,"mousemove",this)}this.scroller._execEvent("beforeScrollStart")},_move:function(t){var i=t.touches?t.touches[0]:t,e,s,o,n,r=m.getTime();if(!this.moved){this.scroller._execEvent("scrollStart")}this.moved=true;e=i.pageX-this.lastPointX;this.lastPointX=i.pageX;s=i.pageY-this.lastPointY;this.lastPointY=i.pageY;o=this.x+e;n=this.y+s;this._pos(o,n);t.preventDefault();t.stopPropagation()},_end:function(t){if(!this.initiated){return}this.initiated=false;t.preventDefault();t.stopPropagation();m.removeEvent(n,"touchmove",this);m.removeEvent(n,m.prefixPointerEvent("pointermove"),this);m.removeEvent(n,"mousemove",this);if(this.scroller.options.snap){var i=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var e=this.options.snapSpeed||u.max(u.max(u.min(u.abs(this.scroller.x-i.x),1e3),u.min(u.abs(this.scroller.y-i.y),1e3)),300);if(this.scroller.x!=i.x||this.scroller.y!=i.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=i;this.scroller.scrollTo(i.x,i.y,e,this.scroller.options.bounceEasing)}}if(this.moved){this.scroller._execEvent("scrollEnd")}},transitionTime:function(t){t=t||0;var i=m.style.transitionDuration;if(!i){return}this.indicatorStyle[i]=t+"ms";if(!t&&m.isBadAndroid){this.indicatorStyle[i]="0.0001ms";var e=this;f(function(){if(e.indicatorStyle[i]==="0.0001ms"){e.indicatorStyle[i]="0s"}})}},transitionTimingFunction:function(t){this.indicatorStyle[m.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none"}else if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none"}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none"}if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){m.addClass(this.wrapper,"iScrollBothScrollbars");m.removeClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="8px"}else{this.wrapper.style.bottom="8px"}}}else{m.removeClass(this.wrapper,"iScrollBothScrollbars");m.addClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="2px"}else{this.wrapper.style.bottom="2px"}}}m.getRect(this.wrapper);if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=u.max(u.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+"px"}else{this.indicatorWidth=this.indicator.clientWidth}this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=="clip"){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX}this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX}if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=u.max(u.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+"px"}else{this.indicatorHeight=this.indicator.clientHeight}this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=="clip"){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY}this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY}this.updatePosition()},updatePosition:function(){var t=this.options.listenX&&u.round(this.sizeRatioX*this.scroller.x)||0,i=this.options.listenY&&u.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(t<this.minBoundaryX){if(this.options.shrink=="scale"){this.width=u.max(this.indicatorWidth+t,8);this.indicatorStyle.width=this.width+"px"}t=this.minBoundaryX}else if(t>this.maxBoundaryX){if(this.options.shrink=="scale"){this.width=u.max(this.indicatorWidth-(t-this.maxPosX),8);this.indicatorStyle.width=this.width+"px";t=this.maxPosX+this.indicatorWidth-this.width}else{t=this.maxBoundaryX}}else if(this.options.shrink=="scale"&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+"px"}if(i<this.minBoundaryY){if(this.options.shrink=="scale"){this.height=u.max(this.indicatorHeight+i*3,8);this.indicatorStyle.height=this.height+"px"}i=this.minBoundaryY}else if(i>this.maxBoundaryY){if(this.options.shrink=="scale"){this.height=u.max(this.indicatorHeight-(i-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+"px";i=this.maxPosY+this.indicatorHeight-this.height}else{i=this.maxBoundaryY}}else if(this.options.shrink=="scale"&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+"px"}}this.x=t;this.y=i;if(this.scroller.options.useTransform){this.indicatorStyle[m.style.transform]="translate("+t+"px,"+i+"px)"+this.scroller.translateZ}else{this.indicatorStyle.left=t+"px";this.indicatorStyle.top=i+"px"}},_pos:function(t,i){if(t<0){t=0}else if(t>this.maxPosX){t=this.maxPosX}if(i<0){i=0}else if(i>this.maxPosY){i=this.maxPosY}t=this.options.listenX?u.round(t/this.sizeRatioX):this.scroller.x;i=this.options.listenY?u.round(i/this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(t,i)},fade:function(t,i){if(i&&!this.visible){return}clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var e=t?250:500,s=t?0:300;t=t?"1":"0";this.wrapperStyle[m.style.transitionDuration]=e+"ms";this.fadeTimeout=setTimeout(function(t){this.wrapperStyle.opacity=t;this.visible=+t}.bind(this,t),s)}};t.utils=m;if(typeof module!="undefined"&&module.exports){module.exports=t}else if(typeof define=="function"&&define.amd){define(function(){return t})}else{n.IScroll=t}})(window,document,Math);
